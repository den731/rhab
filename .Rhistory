legend.title=element_blank(),
legend.position="bottom",
axis.text.x = element_text(
angle = 90,
size = 7,
vjust = 0.4)
) +
geom_hline(
yintercept = 4,
color="#BB0000",
linetype="dashed",
show.legend = FALSE
) +
geom_text(aes(17,4.9, label = "EPA Guideline"), color="#BB0000", show.legend=FALSE) +
scale_color_manual(labels = c("MC from ELISA", "MC from LC-MS/MS"), values = c("green", "black"))
a
July %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX('Average MC ($\\mu$g/L)')) +
xlab("Lakes")
July %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX('Average MC ($\\mu$g/L)')) +
xlab("Lakes")
July %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX('Average MC ($\\mu$g/L)')) +
xlab("Lakes")
July %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
July <- Delta %>% filter(Month == "7") %>% gather(congener, value, Nodul:MC_LF)
August <- Delta %>% filter(Month == "8") %>% gather(congener, value, Nodul:MC_LF)
Sept <- Delta %>% filter(Month == "9") %>% gather(congener, value, Nodul:MC_LF)
Oct <- Delta %>% filter(Month == "10") %>% gather(congener, value, Nodul:MC_LF)
d<-Oct %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
c
c
Sept %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
d<-Oct %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
d
plot_grid(a,b, ncol = 2, rel_heights = c(10, 0.1),rel_widths = c(1,1/3))
plot_grid(a,b,c,d, ncol = 2)
a<-July %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
b<-August %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
c<-Sept %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
d<-Oct %>%
ggplot(aes(x=LK_CODE)) +
geom_bar(stat="identity", aes(y=value, fill=congener, width=1))  +
scale_fill_viridis(discrete=TRUE,option="B",
label=c( "[D-Asp3] MC-LR",
"[D-Asp3] MC-RR",
"MC-HilR",
"MC-HtyR",
"MC-LA",
"MC-LF",
"MC-LR",
"MC-LW",
"MC-LY",
"MC-RR",
"MC-WR",
"MC-YR",
"Nodularin")) +
geom_point(aes(x=LK_CODE, y=ELISA, color="ELISA")) +
theme_classic() +
scale_color_manual(labels = c("MC from ELISA"), values = c("green")) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4),
legend.key.height = unit(1.8,"line"),
legend.title  = element_blank()) +
ylab(TeX(' MC ($\\mu$g/L)')) +
xlab("Lakes")
plot_grid(a,b,c,d, ncol = 2)
D <- UltimateFactor %>%
ggplot(aes(x=LK_CODE, DO)) +
stat_summary(fun.y=mean, geom = "bar", fill="white",
na.rm = T,
color="black") + theme_cowplot() +
stat_summary(fun.data = mean_se, geom = "errorbar", width=0.5) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4)) +
xlab(" ")
UltimateFactor %>%
ggplot(aes(x=LK_CODE, DO)) +
stat_summary(fun.y=mean, geom = "bar", fill="white",
na.rm = T,
color="black") + theme_cowplot() +
stat_summary(fun.data = mean_se, geom = "errorbar", width=0.5) +
theme(axis.text.x = element_text(angle = 90, size = 7, vjust = 0.4)) +
xlab(" ")
cong_spatt <- UltimateFactor %>% gather(congener, average, S_D_Asp3_RR:S_MC_LW) %>% group_by(LK_CODE, congener) %>%
summarise_at(vars(average), mean, na.rm=TRUE)
ong_spatt %>%
ggplot(aes(x=LK_CODE, y=average, fill=congener, width=1)) +
geom_bar(stat="identity")  +
scale_fill_viridis(discrete=TRUE,option="B", label=c( "[D-Asp3] MC-RR","[D-Atsp3] MC-LR",    "MC-HilR", "MC-HtyR","MC-LA", "MC-LR",  "MC-LW", "MC-LY","MC-RR", "MC-WR", "MC-YR", "Nodularin")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, size = 8, vjust = 0.4),
legend.key.height = unit(1.46,"line"),
legend.title  = element_blank()) +
ylab(TeX('Average Concent. (ng of MC / g of resin)')) +
xlab("Lakes")
cong_spatt %>%
ggplot(aes(x=LK_CODE, y=average, fill=congener, width=1)) +
geom_bar(stat="identity")  +
scale_fill_viridis(discrete=TRUE,option="B", label=c( "[D-Asp3] MC-RR","[D-Atsp3] MC-LR",    "MC-HilR", "MC-HtyR","MC-LA", "MC-LR",  "MC-LW", "MC-LY","MC-RR", "MC-WR", "MC-YR", "Nodularin")) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, size = 8, vjust = 0.4),
legend.key.height = unit(1.46,"line"),
legend.title  = element_blank()) +
ylab(TeX('Average Concent. (ng of MC / g of resin)')) +
xlab("Lakes")
plot_grid(a + theme(legend.position = "none"),
b + theme(legend.position = "none"),
c + theme(legend.position = "none"),
d + theme(legend.position = "none"), ncol = 2)
plot_grid(a + theme(legend.position = "none"),
b + theme(legend.position = "none"),
c + theme(legend.position = "none"),
d + theme(legend.position = "none"),
align = 'vh',
ncol = 2)
plot_grid(a + theme(legend.position = "none"),
b + theme(legend.position = "none"),
c + theme(legend.position = "none"),
d + theme(legend.position = "none"),
labels = c("A", "B", "C", "D"),
align = 'vh',
ncol = 2)
legend_b <- get_legend(a + theme(legend.position = "bottom"))
dd <- plot_grid(a + theme(legend.position = "none"),
b + theme(legend.position = "none"),
c + theme(legend.position = "none"),
d + theme(legend.position = "none"),
labels = c("A", "B", "C", "D"),
align = 'vh',
ncol = 2)
plot_grid(dd, legend_b)
plot_grid(dd, legend_b, ncol=1)
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .2))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .1))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .04))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .004))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .01))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .01), rel_widths = c(1,0.01))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .01), rel_widths = c(1,0.01))
legend_b <- get_legend(a + theme(legend.position = "bottom", legend.key.size = 2))
legend_b <- get_legend(a + theme(legend.position = "bottom", legend.key.size = 0.6))
legend_b <- get_legend(a + theme(legend.position = "bottom", legend.key.size = unit(0.6,"cm")))
dd <- plot_grid(a + theme(legend.position = "none"),
b + theme(legend.position = "none"),
c + theme(legend.position = "none"),
d + theme(legend.position = "none"),
labels = c("A", "B", "C", "D"),
align = 'vh',
ncol = 2)
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .01), rel_widths = c(1,0.01))
legend_b <- get_legend(a + theme(legend.position = "bottom", legend.key.size = unit(0.2,"cm")))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .01), rel_widths = c(1,0.01))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .1), rel_widths = c(1,0.01))
plot_grid(dd, legend_b, ncol=1)
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .2), rel_widths = c(1,0.01))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .2), rel_widths = c(1,0.2))
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .2), rel_widths = c(1,0.2))
ggsave("month.eps", device="eps")
View(zUltimateSheet)
plot_grid(a,b, ncol = 2,
rel_heights = c(10, 0.1),
labels=c('A' , 'B'),
rel_widths = c(1,1/3))
ggsave("congenerbar.eps", device = "eps" , width = 6, height = 5.5)
congenerssz %>%
ggplot(aes(x=reorder(Congener, desc(Congener)), y=Concentrations, width=0.3, fill=Congener, show)) +
stat_summary(fun.y=mean, geom = "bar",na.rm = T,color="black", show.legend = NA) +
theme_cowplot() +
stat_summary(fun.data = mean_se, geom = "errorbar", width=0.5) +
#scale_x_discrete(label=c(
#  "Nodularin",
#  "MC-YR",
#  "MC-WR",
#  "MC-RR",
#  "MC-LY",
#  "MC-LW",
#  "MC-LR",
#  "MC-LF",
# "MC-LA",
#  "MC-HtyR",
# "MC-HilR",
#  "[D-Asp3] MC-RR",
#  "[D-Asp3] MC-LR"
#  )) +
ylab(TeX('Average MC($\\mu$g/L)}'))  +
xlab(" ") +
theme(axis.text.y=element_blank(),
axis.text.x=element_text(2),
axis.title.x=element_text(size=10),
axis.title.y=element_blank(),
axis.ticks.y=element_blank(),
panel.grid.major=element_blank(),
axis.line=element_blank()) +
scale_fill_viridis(discrete=TRUE,option="B", guide = FALSE) +
coord_flip()
plot_grid(dd, legend_b, ncol=1, rel_heights = c(1, .2), rel_widths = c(1,0.2))
Model <- lm(SUM~phyco,
data = MCSUMresponseAverage)
Anova(Model, test.statistic = "F")
library(car)
library(lme4)
Anova(Model, test.statistic = "F")
plot(Model)
Anova(Model1, test.statistic = "F")
plot(Model)
plot(Model)
Model <- lmer(SUM~Developed +
(1|LK_CODE),
data=LOGTransformed)
summary(Model1)
Model1  <- lmer(SUM~OP + phyco + (1|LK_CODE),
data=LOGTransformed)
summary(Model1)
Anova(Model1, test.statistic = "F")
Model <- lmer(SUM~Developed +
(1|LK_CODE),
data=LOGTransformed)
summary(Model)
Anova(Model, test.statistic ="F")
Model <- lm(MCSUMresponseAverage$OP~MCSUMresponseAverage$turb)
plot(Model)
# Ommited outliers 4 and 26
Omit <- MCSUMresponseAverage %>% slice(c(26,4))
View(Omit)
# Ommited outliers 4 and 26
Omit <- MCSUMresponseAverage %>% slice(26)
View(Omit)
# Ommited outliers 4 and 26
Omit <- MCSUMresponseAverage %>% slice(-26)
plot(Omit$SUM~Omite$turb, xlab = "log10(mcyE) gene copies", ylab = "log10(MC) ")
plot(Omit$SUM~Omit$turb, xlab = "log10(mcyE) gene copies", ylab = "log10(MC) ")
plot(Omit$SUM~Omit$turb, xlab = "log10(mcyE) gene copies", ylab = "log10(MC) ")
abline(lm(SUM~MCYE, data=MCSUMresponseAverage))
plot(Omit$SUM~Omit$turb, xlab = "log10(mcyE) gene copies", ylab = "log10(MC) ")
abline(lm(SUM~turb, data=Omit))
setEPS()
postscript(file="plot1.eps", width = 8, height = 8)
par(mfrow=c(1,2))
plot(MCSUMresponseAverage$OP~MCSUMresponseAverage$turb, ylab = "log10(OP)", xlab = "log10(turb)")
abline(lm(OP~turb, data=MCSUMresponseAverage))
title("A", adj = 0)
plot(Omit$SUM~Omit$turb, xlab = "log10(mcyE) gene copies", ylab = "log10(MC) ")
abline(lm(SUM~turb, data=Omit))
title("B", adj = 0)
dev.off()
plot(Omit$OP~Omit$turb, xlab = "log10(OP)", ylab = "log10(turb) ")
abline(lm(OP~turb, data=Omit))
# Ommited outliers 4 and 26
Omit <- MCSUMresponseAverage %>% slice(c(-26,4))
plot(Omit$OP~Omit$turb, xlab = "log10(OP)", ylab = "log10(turb) ")
abline(lm(OP~turb, data=Omit))
# Ommited outliers 4 and 26
Omit <- MCSUMresponseAverage %>% slice(c(-26,-4))
plot(Omit$OP~Omit$turb, xlab = "log10(OP)", ylab = "log10(turb) ")
abline(lm(OP~turb, data=Omit))
Model <- (lm(OP~turb, data=Omit))
Anova(Model)
Anova(Model, test.statistics="F")
summary(Model)
Anova(Model, test.statistics="F")
setEPS()
postscript(file="plot1.eps", width = 8, height = 8)
par(mfrow=c(1,2))
plot(MCSUMresponseAverage$OP~MCSUMresponseAverage$turb, ylab = "log10(OP)", xlab = "log10(turb)")
abline(lm(OP~turb, data=MCSUMresponseAverage))
title("A", adj = 0)
plot(Omit$OP~Omit$turb, xlab = "log10(OP)", ylab = "log10(turb) ")
abline(lm(OP~turb, data=Omit))
title("B", adj = 0)
dev.off()
setEPS()
postscript(file="plot1.eps", width = 8, height = 8)
par(mfrow=c(1,2))
plot(MCSUMresponseAverage$OP~MCSUMresponseAverage$turb, ylab = "log10(OP)", xlab = "log10(turb)")
abline(lm(OP~turb, data=MCSUMresponseAverage))
title("A", adj = 0)
plot(Omit$OP~Omit$turb, xlab = "log10(turb) ", ylab = "log10(OP)")
abline(lm(OP~turb, data=Omit))
title("B", adj = 0)
dev.off()
